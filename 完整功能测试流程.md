# 书店租书管理系统 - 完整功能测试流程

## 系统架构
- **后端**: Spring Boot 3 + MyBatis Plus (端口: 8080)
- **前端**: Vue 3 + Vite (端口: 5173)
- **数据库**: MySQL 5.7

## 环境准备

### 1. 数据库准备
```sql
-- 创建数据库
CREATE DATABASE library_management CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 导入数据库脚本
USE library_management;
SOURCE src/main/resources/complete_database_init.sql;
```

### 2. 后端启动
```bash
# 在项目根目录
mvn clean install
mvn spring-boot:run
```

### 3. 前端启动
```bash
# 在 LibraryManagementSys250702_frontend 目录
npm install
npm run dev
```

### 4. 访问系统
- **前端地址**: http://localhost:5173
- **后端API**: http://localhost:8080/api

## 测试账户

| 用户名 | 密码 | 角色 | 描述 |
|--------|------|------|------|
| admin | admin123 | 管理员 | 系统管理员，可管理用户、书籍等 |
| customer1 | 123456 | 客户 | 普通客户，可借书、还书 |
| customer2 | 123456 | 客户 | 普通客户，可借书、还书 |

## 功能测试清单

### 管理员功能测试

#### 1. 管理员登录测试
**测试步骤：**
1. 访问 http://localhost:5173
2. 输入用户名: `admin`，密码: `admin123`
3. 点击登录

**预期结果：**
- 登录成功，跳转到管理员仪表板 `/admin/dashboard`
- 界面显示管理员专用菜单

#### 2. 用户管理测试 (/admin/users)
**功能点：**
- 查看用户列表
- 添加新用户
- 编辑用户信息
- 给用户充值
- 用户状态管理（启用/禁用）
- 模糊搜索用户

**测试数据：**
```
新用户信息：
用户名: testuser
真实姓名: 测试用户
邮箱: test@example.com
手机: 13800138000
```

#### 3. 书籍管理测试 (/admin/books)
**功能点：**
- 查看书籍列表
- 添加新书籍
- 编辑书籍信息
- 删除书籍
- 书籍分类管理
- 按条件搜索书籍

**测试数据：**
```
新书籍信息：
书名: 测试图书
作者: 测试作者
ISBN: 9787000000000
分类: 测试
出版社: 测试出版社
库存: 10
价格: 25.00
```

#### 4. 借阅记录管理测试 (/admin/records)
**功能点：**
- 查看所有借阅记录
- 管理逾期记录
- 处理还书请求
- 借阅记录统计

#### 5. 收费标准管理测试 (/admin/fees)
**功能点：**
- 查看收费标准列表
- 添加新收费标准
- 编辑收费标准
- 删除收费标准
- 启用/禁用收费标准

**测试数据：**
```
收费标准信息：
收费类型: 1(借阅费)
书籍分类: 计算机
费用金额: 3.00
计费单位: 1(按天)
描述: 计算机类图书借阅费，每天3元
```

#### 6. 统计分析测试 (/admin/statistics)
**功能点：**
- 查看总体统计数据
- 用户年龄分布统计
- 书籍类别分布统计
- 热门图书排行
- 借阅趋势分析

#### 7. Excel批量导入测试

##### 7.1 用户批量导入
**Excel模板格式 (用户导入模板.xlsx)：**
| 用户名 | 真实姓名 | 性别 | 年龄 | 手机号 | 邮箱 |
|--------|----------|------|------|--------|------|
| user001 | 张三 | 男 | 25 | 13800138001 | zhang@test.com |
| user002 | 李四 | 女 | 23 | 13800138002 | li@test.com |
| user003 | 王五 | 男 | 28 | 13800138003 | wang@test.com |

**测试步骤：**
1. 创建Excel文件，按上述格式填入测试数据
2. 在管理员界面选择"用户管理"
3. 点击"批量导入"按钮
4. 选择Excel文件上传
5. 查看导入结果

##### 7.2 书籍批量导入
**Excel模板格式 (书籍导入模板.xlsx)：**
| 书名 | 作者 | ISBN | 分类 | 出版社 | 出版年份 | 库存数量 | 价格 | 描述 |
|------|------|------|------|--------|----------|----------|------|------|
| Java编程思想 | Bruce Eckel | 9787111213826 | 计算机 | 机械工业出版社 | 2021 | 15 | 89.00 | Java编程经典教材 |
| 数据结构与算法 | 严蔚敏 | 9787302147510 | 计算机 | 清华大学出版社 | 2020 | 20 | 65.00 | 数据结构基础教材 |

**测试步骤：**
1. 创建Excel文件，按上述格式填入测试数据
2. 在管理员界面选择"书籍管理"
3. 点击"批量导入"按钮
4. 选择Excel文件上传
5. 查看导入结果

### 客户功能测试

#### 1. 客户登录测试
**测试步骤：**
1. 访问 http://localhost:5173
2. 输入用户名: `customer1`，密码: `123456`
3. 点击登录

**预期结果：**
- 登录成功，跳转到客户仪表板 `/customer/dashboard`
- 界面显示客户专用菜单

#### 2. 图书搜索测试 (/customer/books)
**功能点：**
- 按书名搜索
- 按作者搜索
- 按分类筛选
- 查看书籍详情
- 检查库存状态

**测试数据：**
```
搜索关键词: "Java"
作者筛选: "刘慈欣"
分类筛选: "文学"
```

#### 3. 图书借阅测试
**功能点：**
- 选择图书借阅
- 设置借阅天数
- 查看费用预估
- 确认借阅

**测试步骤：**
1. 在图书搜索页面找到可借图书
2. 点击"借阅"按钮
3. 设置借阅天数（如7天）
4. 确认借阅信息和费用
5. 提交借阅申请

#### 4. 借阅历史测试 (/customer/history)
**功能点：**
- 查看借阅历史记录
- 查看当前借阅状态
- 申请还书
- 查看费用明细

#### 5. 个人信息管理测试 (/customer/profile)
**功能点：**
- 查看个人信息
- 修改个人信息
- 修改密码
- 查看账户余额
- 账户充值

### 系统完整流程测试

#### 场景1：完整借还书流程
1. **管理员操作：**
   - 初始化系统数据（书籍、收费标准）
   - 给客户账户充值

2. **客户操作：**
   - 登录系统
   - 搜索并借阅图书
   - 查看借阅记录

3. **时间推进测试：**
   - 修改数据库中的借阅时间，模拟超期
   - 客户还书
   - 系统自动计算超期费用

4. **管理员验证：**
   - 查看借阅记录
   - 查看罚款记录
   - 验证统计数据

#### 场景2：Excel批量导入测试
1. **准备数据：**
   - 创建用户导入Excel文件（20个用户）
   - 创建书籍导入Excel文件（50本书籍）

2. **批量导入：**
   - 导入用户数据
   - 导入书籍数据
   - 验证导入结果

3. **数据验证：**
   - 检查用户列表
   - 检查书籍列表
   - 验证数据完整性

#### 场景3：收费标准管理测试
1. **设置收费标准：**
   - 添加不同分类的借阅费标准
   - 设置超期罚款标准
   - 设置损坏和丢失赔偿标准

2. **应用测试：**
   - 借阅不同分类的图书
   - 验证费用计算是否正确
   - 测试超期罚款计算

#### 场景4：统计分析测试
1. **数据准备：**
   - 确保有足够的借阅记录
   - 有不同年龄段的用户
   - 有不同分类的图书

2. **统计验证：**
   - 查看用户年龄分布
   - 查看书籍类别分布
   - 查看热门图书排行
   - 验证数据准确性

## 性能测试

### 1. 并发测试
- 模拟多用户同时借阅同一本书
- 测试库存扣减的准确性
- 验证数据一致性

### 2. 大数据量测试
- 导入大量用户数据（1000+）
- 导入大量书籍数据（5000+）
- 测试查询性能
- 测试分页功能

## 测试验证点

### 数据库完整性验证
- [ ] 外键约束正常工作
- [ ] 触发器正常执行
- [ ] 逻辑删除功能正常
- [ ] 数据库索引生效

### 业务逻辑验证
- [ ] 借阅时库存正确扣减
- [ ] 还书时库存正确恢复
- [ ] 超期自动计算罚款
- [ ] 余额不足时无法借阅
- [ ] 角色权限控制正确

### 用户体验验证
- [ ] 界面响应速度正常
- [ ] 错误信息提示清晰
- [ ] 操作流程符合逻辑
- [ ] 数据展示格式正确

## 常见问题排查

### 1. 数据库连接问题
- 检查MySQL服务是否启动
- 验证数据库连接配置
- 确认数据库用户权限

### 2. 前后端通信问题
- 检查后端服务是否启动
- 验证API接口地址配置
- 查看浏览器控制台错误信息

### 3. 文件上传问题
- 确认Excel文件格式正确
- 检查文件大小限制
- 验证文件内容格式

### 4. 权限访问问题
- 确认用户角色正确
- 检查JWT token是否有效
- 验证路由权限配置

## 测试完成标准

系统测试完成需要满足以下标准：
- [ ] 所有核心功能正常运行
- [ ] 用户角色权限控制正确
- [ ] Excel导入功能正常
- [ ] 收费标准管理功能完整
- [ ] 统计分析功能准确
- [ ] 数据库设计符合3NF
- [ ] 外键和触发器正常工作
- [ ] 前后端交互无错误
- [ ] 界面友好，操作流畅

## 附录：Excel模板文件

### 用户导入模板 (users_template.xlsx)
```
列A: 用户名 (必填，唯一)
列B: 真实姓名 (必填)
列C: 性别 (男/女 或 1/0)
列D: 年龄 (数字)
列E: 手机号 (11位数字)
列F: 邮箱 (邮箱格式)
```

### 书籍导入模板 (books_template.xlsx)
```
列A: 书名 (必填)
列B: 作者 (必填)
列C: ISBN (可选，如有必须唯一)
列D: 分类 (必填)
列E: 出版社 (可选)
列F: 出版年份 (数字)
列G: 库存数量 (数字，默认1)
列H: 价格 (数字，默认0)
列I: 描述 (可选)
```

## 系统设计验证

### 数据库设计验证 (3NF标准)
1. **第一范式(1NF)**: 每个属性都是不可分割的原子值
2. **第二范式(2NF)**: 非主属性完全依赖于主键
3. **第三范式(3NF)**: 非主属性不传递依赖于主键

### 外键约束验证
- users表与borrowing_records表的外键关系
- books表与borrowing_records表的外键关系
- borrowing_records表与fine_records表的外键关系

### 触发器功能验证
- 借阅时自动减少可借数量
- 还书时自动增加可借数量
- 超期还书自动生成罚款记录
- 自动计算超期天数 